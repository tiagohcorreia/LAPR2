@startuml
skinparam monochrome true
skinparam packageStyle rectangle
skinparam shadowing false

autonumber

'hide footbox
actor "Agent" as AG
participant ":PublishAnnouncementUI" as UI
participant ":PublishAnnouncementController" as CTRL
participant ":Repositories" as RepositorySingleton
participant "repositories\n:Repositories" as REP
participant ":AnnouncementRepository" as AnnouncementREP
participant ":PropertyRepository" as PropertyREP
participant ":Announcement" as Announcement

activate AG

        AG -> UI : asks to publish an announcement
        activate UI

        UI --> AG : request data

        AG -> UI : select the property type

               UI -> CTRL** : create

               UI -> CTRL : getProperty()

                 activate CTRL

                  CTRL -> RepositorySingleton : getInstance()
                  activate RepositorySingleton

                  RepositorySingleton --> CTRL: repositories
                  deactivate RepositorySingleton

                   CTRL -> REP : getPropertyRepository()
                       activate REP

                        REP --> CTRL: PropertyRepository
                          deactivate REP

                           CTRL -> PropertyREP : getPropertyPropertyRepository()
                             activate PropertyREP

                               PropertyREP --> CTRL: Property
                                 deactivate PropertyREP


                   CTRL --> UI : Property

                   UI --> AG : presents the data to be\n filled in by the type of porperty

                   AG -> UI : insert the requested data (size, location, distance \nfrom the city center, price, commission)

                   UI --> AG : validate data

                   AG -> UI : submits data

                   UI -> CTRL : createAnnouncement (size, location,\n distance from the city \n center, price, commission)

                CTRL -> AnnouncementREP: createAnnouncement(size, location,\n distance from the city \n center, price, commission)
            activate AnnouncementREP

                AnnouncementREP -> Announcement**: create(size, location,\n distance from the city \n center, price, commission)
                AnnouncementREP -> AnnouncementREP: addAnnouncement (Announcement)


                activate AnnouncementREP
                    AnnouncementREP -> AnnouncementREP: validateAnnouncement(Announcement))
                    activate AnnouncementREP
                        AnnouncementREP --> AnnouncementREP
                    deactivate AnnouncementREP

                    AnnouncementREP --> AnnouncementREP
                deactivate AnnouncementREP

                AnnouncementREP --> CTRL : task

                deactivate AnnouncementREP

                            CTRL --> UI: Announcement
                            deactivate CTRL
                            UI --> AG: displays operation success
                    deactivate UI

                deactivate AG


          @enduml